#!/usr/bin/env bash
#
# This file is autogenerated.  Do not edit
#
set -e
export SCRIPT_HOME=$( cd "$( dirname "$0" )" &> /dev/null && pwd )
export PROJ_HOME=$SCRIPT_HOME/../src/main
export OUTPUT_DIR=$SCRIPT_HOME/../src/c
export EXTS=$OUTPUT_DIR/ext/ext.c:$OUTPUT_DIR/ext/ext.h:$OUTPUT_DIR/ext/ipc.c:$OUTPUT_DIR/ext/ipc.h

if [ -n "$1" ]; then
  TRANSPILER_JAR_HOME=$1
fi

if [ -z "$TRANSPILER_JAR_HOME" ]; then
  echo "Specify the location of the Sireum-Transpiler jar file"
  exit 1
fi

$TRANSPILER_JAR_HOME transpiler c \
  --sourcepath $PROJ_HOME \
  --apps "proj.Ping_i_App,proj.Pong_i_App,proj.Main" \
  --forward "art.ArtNative=proj.ArtNix,proj.Platform=proj.PlatformNix" \
  --verbose \
  --bits 16 \
  --string-size 103 \
  --sequence-size 7 \
  --output-dir $OUTPUT_DIR \
  --exts $EXTS
